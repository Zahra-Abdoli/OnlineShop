@*@model IEnumerable<OnlineShop.Core.Product>*@
@model OnlineShop.Core.ViewModels.ProductAdminViewModel

@{
    ViewBag.Title = "Home Page";
    //IEnumerable<OnlineShop.Core.Models.Comment> commentList = ViewBag.Comments as
    //IEnumerable<OnlineShop.Core.Models.Comment>;
    //var comments = ViewBag.Comments as IEnumerable<OnlineShop.Core.Models.Comment>;
    //var comments = (IEnumerable<OnlineShop.Core.Models.Comment>);
    var starRating = 0;
    var ratingSum = 0;
    var ratingCount = 0;
    decimal rating = 0;
    var totalStarRating = 0;
    if (ratingCount > 0)
    {
        rating = (ratingSum / ratingCount);
    }
    var totalRating = decimal.Parse(rating.ToString());
}


<h1>Products</h1>

@foreach (var item in Model.products)
{

<div class="col-md-20" style="height:450px; padding:10px; margin:10px; border:solid thin whitesmoke">
    <div class="col-md-12">

        <img class="img" style="height:250px" src="~/Content/ProductImages/@item.Image" />
    </div>

    <div class="col-md-12">
        <strong>@Html.ActionLink(item.Name, "Details", new { id = item.Id })</strong>
    </div>

    @foreach (var rate in Model.comments)
    {

        starRating = rate.Rating;
        totalStarRating += starRating;
        if (totalStarRating < 100)
        {
            starRating = 3;
        }
        else
        {
            starRating = 5;
        }

        @*<div class="col-md-12">
            @for (int i = 0; i < rate.Rating; i++)
            {
                <span class="starGlowN"></span>
            }
            @for (int i = rate.Rating; i < 5; i++)
            {
                <span class="starFadeN"></span>
            }
            </div>*@


    }
    @*<div class="col-md-12">
        @totalStarRating
    </div>*@
    @if (@totalStarRating <= 100)
    {
        for (var i = 1; i <= @starRating; i++)
        {
            <span class="starGlowN"></span>
        }
        for (var i = (@starRating + 1); i <= 5; i++)
        {
            <span class="starFadeN"></span>
        }

    }
    @if (@totalStarRating >= 100)
    {
        for (var i = 1; i <= @starRating; i++)
        {
            <span class="starGlowN"></span>
        }
        for (var i = (@starRating + 1); i <= 5; i++)
        {
            <span class="starFadeN"></span>
        }

    }



    @*<sp<an class="starFadeN" id="sRate1"></span>
        <span class="starFadeN" id="sRate2"></span>
        <span class="starFadeN" id="sRate3">
        </span><span class="starFadeN" id="sRate4">
        </span><span class="starFadeN" id="sRate5"></span>*@

    @*<div class="col-md-12">
        <p>@item.Description</p>
    </div>*@
    <div class="col-md-12">
        <h4>@item.Price</h4>
    </div>
    <div class="col-md-12">
        <a href="@Url.Action("AddToBasket", "Basket", new { Id = item.Id })" class="btn btn-default">Add to Basket</a>
    </div>
    @*<div class="col-md-12">
            @Html.Partial("_CommentBox")
        </div>*@
</div>
    @Html.Partial("_CommentBox")
    }

    @*@foreach (var r in ratings)
        {
            <hr />
            <div class="row">
                <div class="col-md-3">
                    <i>@r.ThisDateTime</i>
                    <br />
                    @for (var i = 1; i <= r.Rating; i++)
                    {
                        <span class="starGlowN"></span>
                    }
                    @for (var i = (r.Rating + 1); i <= 5; i++)
                    {
                        <span class="starFadeN"></span>
                    }
                </div>
                <div class="col-md-9">
                    @Html.Raw(r.Comments.Replace("\n", "<br />"))


                </div>
            </div>
        }
        <hr />*@

    @*<script>
            function SCRate() {
                for (var i = 1; i <= @totalRating; i++) {
                    $("#sRate" + i).attr('class', 'starGlowN');
                }
            }
            $(function(){
                SCRate();
            });
        </script>*@

    <div class="col-md-12 clearfix">
